{"ast":null,"code":"import adjust_lon from '../common/adjust_lon';\nimport { HALF_PI, EPSLN } from '../constants/values';\nimport asinz from '../common/asinz';\n/* Initialize the Van Der Grinten projection\n  ----------------------------------------*/\n\nexport function init() {\n  //this.R = 6370997; //Radius of earth\n  this.R = this.a;\n}\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  /* Forward equations\n    -----------------*/\n\n  var dlon = adjust_lon(lon - this.long0);\n  var x, y;\n\n  if (Math.abs(lat) <= EPSLN) {\n    x = this.x0 + this.R * dlon;\n    y = this.y0;\n  }\n\n  var theta = asinz(2 * Math.abs(lat / Math.PI));\n\n  if (Math.abs(dlon) <= EPSLN || Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {\n    x = this.x0;\n\n    if (lat >= 0) {\n      y = this.y0 + Math.PI * this.R * Math.tan(0.5 * theta);\n    } else {\n      y = this.y0 + Math.PI * this.R * -Math.tan(0.5 * theta);\n    } //  return(OK);\n\n  }\n\n  var al = 0.5 * Math.abs(Math.PI / dlon - dlon / Math.PI);\n  var asq = al * al;\n  var sinth = Math.sin(theta);\n  var costh = Math.cos(theta);\n  var g = costh / (sinth + costh - 1);\n  var gsq = g * g;\n  var m = g * (2 / sinth - 1);\n  var msq = m * m;\n  var con = Math.PI * this.R * (al * (g - msq) + Math.sqrt(asq * (g - msq) * (g - msq) - (msq + asq) * (gsq - msq))) / (msq + asq);\n\n  if (dlon < 0) {\n    con = -con;\n  }\n\n  x = this.x0 + con; //con = Math.abs(con / (Math.PI * this.R));\n\n  var q = asq + g;\n  con = Math.PI * this.R * (m * q - al * Math.sqrt((msq + asq) * (asq + 1) - q * q)) / (msq + asq);\n\n  if (lat >= 0) {\n    //y = this.y0 + Math.PI * this.R * Math.sqrt(1 - con * con - 2 * al * con);\n    y = this.y0 + con;\n  } else {\n    //y = this.y0 - Math.PI * this.R * Math.sqrt(1 - con * con - 2 * al * con);\n    y = this.y0 - con;\n  }\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n/* Van Der Grinten inverse equations--mapping x,y to lat/long\n  ---------------------------------------------------------*/\n\nexport function inverse(p) {\n  var lon, lat;\n  var xx, yy, xys, c1, c2, c3;\n  var a1;\n  var m1;\n  var con;\n  var th1;\n  var d;\n  /* inverse equations\n    -----------------*/\n\n  p.x -= this.x0;\n  p.y -= this.y0;\n  con = Math.PI * this.R;\n  xx = p.x / con;\n  yy = p.y / con;\n  xys = xx * xx + yy * yy;\n  c1 = -Math.abs(yy) * (1 + xys);\n  c2 = c1 - 2 * yy * yy + xx * xx;\n  c3 = -2 * c1 + 1 + 2 * yy * yy + xys * xys;\n  d = yy * yy / c3 + (2 * c2 * c2 * c2 / c3 / c3 / c3 - 9 * c1 * c2 / c3 / c3) / 27;\n  a1 = (c1 - c2 * c2 / 3 / c3) / c3;\n  m1 = 2 * Math.sqrt(-a1 / 3);\n  con = 3 * d / a1 / m1;\n\n  if (Math.abs(con) > 1) {\n    if (con >= 0) {\n      con = 1;\n    } else {\n      con = -1;\n    }\n  }\n\n  th1 = Math.acos(con) / 3;\n\n  if (p.y >= 0) {\n    lat = (-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;\n  } else {\n    lat = -(-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;\n  }\n\n  if (Math.abs(xx) < EPSLN) {\n    lon = this.long0;\n  } else {\n    lon = adjust_lon(this.long0 + Math.PI * (xys - 1 + Math.sqrt(1 + 2 * (xx * xx - yy * yy) + xys * xys)) / 2 / xx);\n  }\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\nexport var names = [\"Van_der_Grinten_I\", \"VanDerGrinten\", \"vandg\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};","map":{"version":3,"sources":["C:/Users/brand/source/repos/das-server/client/node_modules/proj4/lib/projections/vandg.js"],"names":["adjust_lon","HALF_PI","EPSLN","asinz","init","R","a","forward","p","lon","x","lat","y","dlon","long0","Math","abs","x0","y0","theta","PI","tan","al","asq","sinth","sin","costh","cos","g","gsq","m","msq","con","sqrt","q","inverse","xx","yy","xys","c1","c2","c3","a1","m1","th1","d","acos","names"],"mappings":"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","sourcesContent":["import adjust_lon from '../common/adjust_lon';\n\nimport {HALF_PI, EPSLN} from '../constants/values';\n\nimport asinz from '../common/asinz';\n\n/* Initialize the Van Der Grinten projection\n  ----------------------------------------*/\nexport function init() {\n  //this.R = 6370997; //Radius of earth\n  this.R = this.a;\n}\n\nexport function forward(p) {\n\n  var lon = p.x;\n  var lat = p.y;\n\n  /* Forward equations\n    -----------------*/\n  var dlon = adjust_lon(lon - this.long0);\n  var x, y;\n\n  if (Math.abs(lat) <= EPSLN) {\n    x = this.x0 + this.R * dlon;\n    y = this.y0;\n  }\n  var theta = asinz(2 * Math.abs(lat / Math.PI));\n  if ((Math.abs(dlon) <= EPSLN) || (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN)) {\n    x = this.x0;\n    if (lat >= 0) {\n      y = this.y0 + Math.PI * this.R * Math.tan(0.5 * theta);\n    }\n    else {\n      y = this.y0 + Math.PI * this.R * -Math.tan(0.5 * theta);\n    }\n    //  return(OK);\n  }\n  var al = 0.5 * Math.abs((Math.PI / dlon) - (dlon / Math.PI));\n  var asq = al * al;\n  var sinth = Math.sin(theta);\n  var costh = Math.cos(theta);\n\n  var g = costh / (sinth + costh - 1);\n  var gsq = g * g;\n  var m = g * (2 / sinth - 1);\n  var msq = m * m;\n  var con = Math.PI * this.R * (al * (g - msq) + Math.sqrt(asq * (g - msq) * (g - msq) - (msq + asq) * (gsq - msq))) / (msq + asq);\n  if (dlon < 0) {\n    con = -con;\n  }\n  x = this.x0 + con;\n  //con = Math.abs(con / (Math.PI * this.R));\n  var q = asq + g;\n  con = Math.PI * this.R * (m * q - al * Math.sqrt((msq + asq) * (asq + 1) - q * q)) / (msq + asq);\n  if (lat >= 0) {\n    //y = this.y0 + Math.PI * this.R * Math.sqrt(1 - con * con - 2 * al * con);\n    y = this.y0 + con;\n  }\n  else {\n    //y = this.y0 - Math.PI * this.R * Math.sqrt(1 - con * con - 2 * al * con);\n    y = this.y0 - con;\n  }\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\n/* Van Der Grinten inverse equations--mapping x,y to lat/long\n  ---------------------------------------------------------*/\nexport function inverse(p) {\n  var lon, lat;\n  var xx, yy, xys, c1, c2, c3;\n  var a1;\n  var m1;\n  var con;\n  var th1;\n  var d;\n\n  /* inverse equations\n    -----------------*/\n  p.x -= this.x0;\n  p.y -= this.y0;\n  con = Math.PI * this.R;\n  xx = p.x / con;\n  yy = p.y / con;\n  xys = xx * xx + yy * yy;\n  c1 = -Math.abs(yy) * (1 + xys);\n  c2 = c1 - 2 * yy * yy + xx * xx;\n  c3 = -2 * c1 + 1 + 2 * yy * yy + xys * xys;\n  d = yy * yy / c3 + (2 * c2 * c2 * c2 / c3 / c3 / c3 - 9 * c1 * c2 / c3 / c3) / 27;\n  a1 = (c1 - c2 * c2 / 3 / c3) / c3;\n  m1 = 2 * Math.sqrt(-a1 / 3);\n  con = ((3 * d) / a1) / m1;\n  if (Math.abs(con) > 1) {\n    if (con >= 0) {\n      con = 1;\n    }\n    else {\n      con = -1;\n    }\n  }\n  th1 = Math.acos(con) / 3;\n  if (p.y >= 0) {\n    lat = (-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;\n  }\n  else {\n    lat = -(-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;\n  }\n\n  if (Math.abs(xx) < EPSLN) {\n    lon = this.long0;\n  }\n  else {\n    lon = adjust_lon(this.long0 + Math.PI * (xys - 1 + Math.sqrt(1 + 2 * (xx * xx - yy * yy) + xys * xys)) / 2 / xx);\n  }\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Van_der_Grinten_I\", \"VanDerGrinten\", \"vandg\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n"]},"metadata":{},"sourceType":"module"}