{"ast":null,"code":"import _defineProperty from\"C:/Users/brand/source/repos/DAS-Server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"C:/Users/brand/source/repos/DAS-Server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/brand/source/repos/DAS-Server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React from'react';import{useForm}from'react-hook-form';import{useSelector,useDispatch}from'react-redux';import{updateModalStepBackwards,closeModal}from'../../../actions/historyPage/modalActions';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ReviewForm(){var _jsx2;var allDriveDays=useSelector(function(state){return state.historyModal.driveDays;});var selectedDriveDateIndex=useSelector(function(state){return state.historyModal.selectedDriveDateIndex;});var selectedDriveDate=useSelector(function(state){return state.historyModal.selectedDriveDate;});var sessionNumber=useSelector(function(state){return state.historyModal.selectedSessionNumber;});var lapNumber=useSelector(function(state){return state.historyModal.selectedLapNumber;});var displayedSessions=useSelector(function(state){return state.historyModal.displayedSessions;});var dispatch=useDispatch();var _useForm=useForm(),handleSubmit=_useForm.handleSubmit,errors=_useForm.errors;var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var sensorData,availableLaps;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"http://localhost:4000/api/v1/data?dates=\".concat(selectedDriveDate,\"&session_numbers=\").concat(sessionNumber,\"&lap_numbers=\").concat(lapNumber,\"&sensors=speeds\"));case 2:sensorData=_context.sent;addNewDateToDisplayedSessions();// console.log(displayedSessions);\navailableLaps=allDriveDays[selectedDriveDateIndex][\"sessions\"][0][\"laps\"].filter(function(lap){return!displayedSessions[selectedDriveDate][\"sessions\"][0][\"laps\"].includes(lap.lap_number);});// console.log(availableLaps);\ndispatch(closeModal());// console.log(sensorData.data);\ncase 6:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();var addNewDateToDisplayedSessions=function addNewDateToDisplayedSessions(){if(!(selectedDriveDate in displayedSessions)){var newSession={sessions:[{number:Number(sessionNumber),laps:[Number(lapNumber)]}]};displayedSessions[selectedDriveDate]=newSession;return;}addNewSessionToDateSessions();};var addNewSessionToDateSessions=function addNewSessionToDateSessions(){var sessionIndex=displayedSessions[selectedDriveDate][\"sessions\"].findIndex(function(session){return session.number==sessionNumber;});if(sessionIndex===-1){displayedSessions[selectedDriveDate][\"sessions\"].push({number:Number(sessionNumber),laps:[Number(lapNumber)]});return;}addNewLapToDateSessions(sessionIndex);};var addNewLapToDateSessions=function addNewLapToDateSessions(sessionIndex){var lapIndex=displayedSessions[selectedDriveDate][\"sessions\"][sessionIndex][\"laps\"].findIndex(function(lap){return lap===Number(lapNumber);});if(lapIndex===-1){displayedSessions[selectedDriveDate][\"sessions\"][sessionIndex][\"laps\"].push(Number(lapNumber));return;}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Review\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"drive-day-data\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"drive-day__date\",children:[\"Drive Day: \",new Date(selectedDriveDate+\" \").toDateString(\"en-us\")]}),/*#__PURE__*/_jsxs(\"div\",{className:\"drive-day__session_number\",children:[\"Session Number: \",sessionNumber]}),/*#__PURE__*/_jsxs(\"div\",{className:\"drive-day__lap_number\",children:[\"Lap Number: \",lapNumber]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){dispatch(updateModalStepBackwards());},className:\"d-block\",children:\"Back\"}),/*#__PURE__*/_jsx(\"button\",(_jsx2={className:\"btn btn-primary\",type:\"submit\"},_defineProperty(_jsx2,\"className\",\"d-block\"),_defineProperty(_jsx2,\"children\",\"Submit\"),_jsx2))]})]})]});}export default ReviewForm;","map":{"version":3,"sources":["C:/Users/brand/source/repos/das-server/client/src/components/historyPage/forms/ReviewForm.js"],"names":["React","useForm","useSelector","useDispatch","updateModalStepBackwards","closeModal","axios","ReviewForm","allDriveDays","state","historyModal","driveDays","selectedDriveDateIndex","selectedDriveDate","sessionNumber","selectedSessionNumber","lapNumber","selectedLapNumber","displayedSessions","dispatch","handleSubmit","errors","onSubmit","data","get","sensorData","addNewDateToDisplayedSessions","availableLaps","filter","lap","includes","lap_number","newSession","sessions","number","Number","laps","addNewSessionToDateSessions","sessionIndex","findIndex","session","push","addNewLapToDateSessions","lapIndex","Date","toDateString"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport {useForm} from 'react-hook-form';\r\nimport {useSelector, useDispatch} from 'react-redux';\r\nimport {updateModalStepBackwards, closeModal} from '../../../actions/historyPage/modalActions';\r\nimport axios from 'axios';\r\n\r\nfunction ReviewForm() {\r\n    const allDriveDays = useSelector( (state) => state.historyModal.driveDays);\r\n    const selectedDriveDateIndex = useSelector( (state) => state.historyModal.selectedDriveDateIndex);\r\n    const selectedDriveDate = useSelector( (state) => state.historyModal.selectedDriveDate);\r\n    const sessionNumber = useSelector( (state) => state.historyModal.selectedSessionNumber);\r\n    const lapNumber = useSelector( (state) => state.historyModal.selectedLapNumber);\r\n    const displayedSessions = useSelector( (state) => state.historyModal.displayedSessions);\r\n    const dispatch = useDispatch();\r\n    const {handleSubmit, errors} = useForm();\r\n\r\n    const onSubmit = async (data) => {\r\n        const sensorData = await axios.get(`http://localhost:4000/api/v1/data?dates=${selectedDriveDate}&session_numbers=${sessionNumber}&lap_numbers=${lapNumber}&sensors=speeds`);\r\n        \r\n        addNewDateToDisplayedSessions();\r\n\r\n        // console.log(displayedSessions);\r\n\r\n        const availableLaps =  allDriveDays[selectedDriveDateIndex][\"sessions\"][0][\"laps\"].filter( (lap) => {\r\n            return !displayedSessions[selectedDriveDate][\"sessions\"][0][\"laps\"].includes(lap.lap_number);\r\n        });\r\n\r\n        // console.log(availableLaps);\r\n\r\n        dispatch(closeModal());\r\n        // console.log(sensorData.data);\r\n    }\r\n\r\n    const addNewDateToDisplayedSessions = () => {\r\n\r\n        if ( !(selectedDriveDate in displayedSessions) ) {\r\n            const newSession = { sessions: [ { number: Number(sessionNumber), laps: [ Number(lapNumber)] } ] }\r\n            displayedSessions[selectedDriveDate] = newSession;\r\n            return\r\n        }\r\n\r\n        addNewSessionToDateSessions();\r\n    }\r\n\r\n    const addNewSessionToDateSessions = () => {\r\n        const sessionIndex = displayedSessions[selectedDriveDate][\"sessions\"].findIndex(session => session.number == sessionNumber);\r\n\r\n        if (sessionIndex === -1) {\r\n            displayedSessions[selectedDriveDate][\"sessions\"].push({ number: Number(sessionNumber), laps: [Number(lapNumber)]});\r\n            return\r\n        }\r\n\r\n        addNewLapToDateSessions(sessionIndex);\r\n    }\r\n\r\n    const addNewLapToDateSessions = (sessionIndex) => {\r\n        const lapIndex = displayedSessions[selectedDriveDate][\"sessions\"][sessionIndex][\"laps\"].findIndex(lap => lap === Number(lapNumber));\r\n       \r\n        if (lapIndex === -1) {\r\n             displayedSessions[selectedDriveDate][\"sessions\"][sessionIndex][\"laps\"].push(Number(lapNumber));\r\n             return\r\n         }\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <h2>Review</h2>\r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n                <div className=\"drive-day-data\">\r\n                    <div className=\"drive-day__date\">\r\n                        Drive Day: {new Date(selectedDriveDate + \" \").toDateString(\"en-us\") }\r\n                    </div>\r\n                    <div className=\"drive-day__session_number\">\r\n                        Session Number: {sessionNumber}\r\n                    </div>\r\n                    <div className=\"drive-day__lap_number\">\r\n                        Lap Number: {lapNumber}\r\n                    </div>\r\n                </div>\r\n                <div className=\"d-flex\">\r\n                    <button type=\"button\" onClick={() => {dispatch(updateModalStepBackwards() )}} className=\"d-block\">Back</button>\r\n                    <button className=\"btn btn-primary\" type=\"submit\" className=\"d-block\">Submit</button>\r\n                </div>\r\n            </form>\r\n    </div>\r\n    )\r\n}\r\n\r\nexport default ReviewForm;\r\n"]},"metadata":{},"sourceType":"module"}