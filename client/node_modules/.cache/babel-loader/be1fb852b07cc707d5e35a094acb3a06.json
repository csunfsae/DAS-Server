{"ast":null,"code":"import _createForOfIteratorHelper from\"C:/Users/brand/source/repos/DAS-Server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import React,{useRef,useEffect}from'react';import{select,line,curveLinear,axisLeft}from'd3';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function SensorGraph(_ref){var sensor=_ref.sensor,sensorData=_ref.sensorData,isFirstSensor=_ref.isFirstSensor,yScale=_ref.yScale,width=_ref.width,index=_ref.index,minValue=_ref.minValue,maxValue=_ref.maxValue;var gRef=useRef(null);var getMinMaxValues=function getMinMaxValues(values){var greatestValue=values[0].value[\"$numberDecimal\"];var lowestValue=values[0].value[\"$numberDecimal\"];var _iterator=_createForOfIteratorHelper(values),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var valueIndex=_step.value;if(parseFloat(valueIndex.value[\"$numberDecimal\"].toString())>greatestValue){greatestValue=valueIndex.value[\"$numberDecimal\"];}if(parseFloat(valueIndex.value[\"$numberDecimal\"].toString())<lowestValue){lowestValue=valueIndex.value[\"$numberDecimal\"];}}}catch(err){_iterator.e(err);}finally{_iterator.f();}return{greatestValue:greatestValue,lowestValue:lowestValue};};var getLongestLap=function getLongestLap(laps){var longestLap=laps[0];// console.log(\"laps\", laps);\nvar _iterator2=_createForOfIteratorHelper(laps),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var lap=_step2.value;if(lap.length>longestLap.length){longestLap=lap;}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}return longestLap;};useEffect(function(){if(gRef.current){(function(){var g=select(gRef.current);var longestLap=getLongestLap(sensorData);var _getMinMaxValues=getMinMaxValues(longestLap),greatestValue=_getMinMaxValues.greatestValue,lowestValue=_getMinMaxValues.lowestValue;var xMultiplier=parseFloat(parseFloat(width-100)/parseFloat(longestLap[longestLap.length-1].lapTime[\"$numberDecimal\"].toString()));var yMultiplier=parseFloat(parseFloat(300)/parseFloat(maxValue));var chartLine=line().x(function(p){return parseFloat(parseFloat(p.lapTime[\"$numberDecimal\"].toString())*xMultiplier);}).y(function(p){return parseFloat(parseFloat(300)-Math.abs(parseFloat(parseFloat(p.value[\"$numberDecimal\"].toString())*parseFloat(yMultiplier))));}).curve(curveLinear);for(var i=0;i<sensorData.length;i++){g.append(\"path\").data([sensorData[i]]).attr(\"d\",function(value){return chartLine(value);}).attr(\"fill\",\"none\").attr(\"stroke\",\"#\"+((1<<24)*Math.random()|0).toString(16)).attr('stroke-width','2px').attr(\"class\",\"line\");}var yAxis=axisLeft(yScale);g.select('.y-axis').call(yAxis);if(!isFirstSensor){g.style('transform',\"translateY(\".concat(index*350,\"px)\"));}})();}},[gRef,width]);return/*#__PURE__*/_jsxs(\"g\",{ref:gRef,className:\"chart\",children:[/*#__PURE__*/_jsx(\"g\",{children:sensor}),/*#__PURE__*/_jsx(\"g\",{className:\"y-axis\"})]});}export default SensorGraph;","map":{"version":3,"sources":["C:/Users/brand/source/repos/DAS-Server/client/src/components/historyPage/graphicalView/SensorGraph/SensorGraph.js"],"names":["React","useRef","useEffect","select","line","curveLinear","axisLeft","SensorGraph","sensor","sensorData","isFirstSensor","yScale","width","index","minValue","maxValue","gRef","getMinMaxValues","values","greatestValue","value","lowestValue","valueIndex","parseFloat","toString","getLongestLap","laps","longestLap","lap","length","current","g","xMultiplier","lapTime","yMultiplier","chartLine","x","p","y","Math","abs","curve","i","append","data","attr","random","yAxis","call","style"],"mappings":"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","sourcesContent":["import React, {useRef, useEffect} from 'react'\r\nimport {select, line, curveLinear, axisLeft} from 'd3';\r\n\r\nfunction SensorGraph({sensor, sensorData, isFirstSensor, yScale, width, index, minValue, maxValue}) {\r\n    const gRef = useRef(null);\r\n\r\n    const getMinMaxValues = (values) =>  {\r\n        let greatestValue = values[0].value[\"$numberDecimal\"];\r\n        let lowestValue = values[0].value[\"$numberDecimal\"];\r\n        \r\n        for (const valueIndex of values) {\r\n\r\n            if (parseFloat(valueIndex.value[\"$numberDecimal\"].toString()) > greatestValue) {\r\n                greatestValue = valueIndex.value[\"$numberDecimal\"]\r\n            }\r\n\r\n            if ( parseFloat(valueIndex.value[\"$numberDecimal\"].toString()) < lowestValue) {\r\n                lowestValue = valueIndex.value[\"$numberDecimal\"]\r\n            }\r\n        }\r\n\r\n        return {\r\n            greatestValue,\r\n            lowestValue\r\n        }\r\n    }\r\n\r\n    const getLongestLap = (laps) => {\r\n        let longestLap = laps[0];\r\n        // console.log(\"laps\", laps);\r\n        for (let lap of laps) {\r\n            if(lap.length > longestLap.length) {\r\n                longestLap = lap;\r\n            }\r\n        }\r\n        return longestLap;\r\n    }\r\n\r\n    useEffect( ()=> {\r\n        if(gRef.current) {\r\n            const g = select(gRef.current);\r\n\r\n            const longestLap = getLongestLap(sensorData);\r\n\r\n            const {greatestValue, lowestValue} = getMinMaxValues(longestLap);\r\n            \r\n            const xMultiplier =  parseFloat(parseFloat(width - 100) / parseFloat(longestLap[longestLap.length - 1].lapTime[\"$numberDecimal\"].toString()));\r\n            const yMultiplier = parseFloat(parseFloat(300) / parseFloat(maxValue));\r\n\r\n\r\n            const chartLine = line().x( p => parseFloat(parseFloat(p.lapTime[\"$numberDecimal\"].toString()) * xMultiplier) ).y( (p) => parseFloat( parseFloat(300) - Math.abs(parseFloat( parseFloat( p.value[\"$numberDecimal\"].toString() ) * parseFloat(yMultiplier ) ))  ) ).curve(curveLinear); \r\n\r\n            for(let i = 0; i < sensorData.length; i++) {\r\n                g.append(\"path\").data([sensorData[i]]).attr(\"d\", value => chartLine(value)).attr(\"fill\", \"none\").attr(\"stroke\", \"#\" + ((1<<24)*Math.random() | 0).toString(16)).attr('stroke-width', '2px').attr(\"class\",\"line\");\r\n            }\r\n\r\n            const yAxis = axisLeft(yScale)\r\n            g.select('.y-axis').call(yAxis)\r\n            \r\n            if(!isFirstSensor) {\r\n                g.style('transform', `translateY(${index * 350}px)`);\r\n            } \r\n        }\r\n\r\n        \r\n\r\n    }, [gRef, width])\r\n\r\n    return (\r\n        <g ref={gRef} className=\"chart\">\r\n            <g>{sensor}</g>\r\n            <g className=\"y-axis\" />\r\n        </g>\r\n    )\r\n}\r\n\r\nexport default SensorGraph;\r\n"]},"metadata":{},"sourceType":"module"}